var user_email=null,user_id=null,user_token=null,user_todos=[],user_todosIDs=[];function signUp(a){a=$("#signUpEmail").val();var b=$("#signUpPassword").val();$.ajax({url:"http://recruiting-api.nextcapital.com/users",type:"POST",data:{email:a,password:b},crossDomain:!0,datatype:"jsonp",success:function(a){assignValues(a)},error:function(a){alert("Error in request. Please try again.")}})}
function signIn(a){a=$("#signInEmail").val();var b=$("#signInPassword").val();$.ajax({url:"http://recruiting-api.nextcapital.com/users/sign_in",type:"POST",data:{email:a,password:b},crossDomain:!0,datatype:"jsonp",success:function(a){assignValues(a)},error:function(a,b,e){alert("Error signing in. Please try again.")}})}
function logoutCurrentUser(a){$.ajax({url:"http://recruiting-api.nextcapital.com/users/sign_out",type:"DELETE",data:{api_token:user_token,user_id:user_id},crossDomain:!0,datatype:"jsonp",success:function(){logOutCleanUp()},error:function(){alert("Issues with logging out. Removing all current data. Please log-in again.");logOutCleanUp()}})}
function logOutCleanUp(){user_todosIDs=user_todos=user_token=user_id=user_email=null;$("#sortable").empty();$("#listsGoHereDiv").hide();$("#logOutButton").hide();$("#writeAndButtonsDiv").show()}
function updateToDo(a){$("#updateTodoModalHeaderLabel").empty();$("#updateTodoModalHeaderLabel").append(a);$("#todoIdContentGoesHere").empty();$("#todoIdContentGoesHere").append('<label class="col-sm-4 control-label" for="updateTodoDescription" style="color:black">Description</label><div class="col-sm-8"><textarea class="form-control" id="updateTodoDescription"></textarea></div><label class="col-sm-4 control-label" for="updateTodoIsComplete" style="color:black">is_complete: </label><div class="col-sm-8"><select class="form-control" id="updateTodoIsComplete"><option value=true>True</option><option value=false>False</option></select></div>');$("#updateATodoModal").modal({show:!0})}
function submitUpdateTodoRequest(){$("#updateATodoModal").modal({show:!1});var a=$("#updateTodoDescription").val(),b=$("#updateTodoIsComplete").val(),c=$("#updateTodoModalHeaderLabel").text(),d="http://recruiting-api.nextcapital.com/users/"+user_id+"/todos/"+c;$("#updateTodoModalHeaderLabel").empty();$("#todoIdContentGoesHere").empty();$.ajax({url:d,type:"PUT",data:{api_token:user_token,todo:{description:a,is_complete:b}},crossDomain:!0,datatypes:"jsonp",success:function(a){updateATodoInList(c,a);
$("#sortable").empty();showDetails()},error:function(a,b,c){alert("Todo cannot be update. Please try again.")}})}function updateATodoInList(a,b){for(var c=user_todos.length-1;0<=c;c--)user_todos[c].id==a&&user_todos.splice(c,1);user_todos.push({description:b.description,id:b.id,is_complete:b.is_complete})}function showCreateANewTodoModal(){$("#addNewTodoModal").modal({show:!0})}
function submitCreateANewTodoRequest(){$("#addNewTodoModal").modal({show:!1});var a=$("#newTodoDescription").val();$.ajax({url:"http://recruiting-api.nextcapital.com/users/"+user_id+"/todos",type:"POST",data:{api_token:user_token,todo:{description:a}},crossDomain:!0,datatypes:"jsonp",success:function(a){user_todos.push({description:a.description,id:a.id,is_complete:a.is_complete});$("#sortable").empty();showDetails()},error:function(a,c,d){alert("Error adding a new todo. Please try again.")}})}
function getUserTodos(a,b){$.ajax({url:"http://recruiting-api.nextcapital.com/users/"+a+"/todos",data:{api_token:b},type:"GET",crossDomain:!0,datatypes:"jsonp",success:function(a){user_todos=a;showDetails()},error:function(a,b,e){alert("Could not retrieve todos. Logout and try again.")}})}function assignValues(a){user_email=a.email;user_id=a.id;user_token=a.api_token;user_todosIDs=a.todos;getUserTodos(user_id,user_token)}
function showDetails(){$("#writeAndButtonsDiv").hide();listUserTodos();$("#logOutButton").show();$("#listsGoHereDiv").show()}
function listUserTodos(){if(null!==user_todos)for(var a=0;a<user_todos.length;a++){var b='<div id="col-sm-12" style="padding-bottom: 15px; padding-top:15px"><li class="ui-state-default" style="color:black"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Description: '+user_todos[a].description+" is_complete: "+user_todos[a].is_complete+'<button id="btn btn-sm btn-primary" style="margin-left: 15px" onClick="updateToDo('+user_todos[a].id+')">Update</button></li></div>';$("#sortable").append(b)}}
$(function(){$("#sortable").sortable();$("#sortable").disableSelection()});
